# Test invalid syntax Debian feed

Set of tests to check the behavior of Vulnerability Detector when the feed has some kind of syntactic error: it doesn't
have a closing tag, it's missing some character...

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 83  | 0:14:17 | test_invalid_syntax_debian_feed.py |

## Test logic

A test is performed for each of the following cases:

- Delete `<`.
- Delete `>`.
- Delete `<>`.
- Close initial tag.
- Delete opening tag.
- Delete closing tag.
- Empty opening tag.
- Empty closing tag.
- Random text before tag.
- Delete info.

In addition, new tests have been added using different characters.

```
['.', ':', '@', '#', '*', '-', '_', "'", '"', '/', '=', 'ñ', 'ç', '+', '^',
 '!', '?', '%', '&', '`', '¿', '?', '(', ')', '|', 'º', '$', '½', '¬',  '!',
 '~', '¡', '[', ']', '{', '}']
```

For each of those characters, these tests will be executed:
 - Replace the symbol `<` with the character.
 - Add the character before an opening tag (`<`).

## Tests

- `test_no_feed_changes`: Check the original feed is successfully imported.
- `test_invalid_syntax_canonical_feed`: The tests are based on modifying the feed causing syntax errors.

## Checks

- [x] The original feed is successfully imported.
- [x] Vulnerabilities are inserted into the `vulnerabilities` database.
- [x] Action status message displayed in `ossec.log`.
- [x] `wazuh-modulesd` is still running once the test has finished (it didn't crash).

## Observed behavior

The feed will not be imported if:

- Delete `<`.
- Delete `>`.
- Delete `<>`.
- Close initial tag.
- Delete opening tag.
- Delete closing tag.
- Empty opening tag.
- Empty closing tag.
- Delete info.
- Replace `<` with other character.

In other cases, the feed will be successfully imported.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 83 items

test_vulnerability_detector/test_feeds/debian/test_invalid_syntax_debian_feed.py ............... [ 18%]
....................................................................                             [100%]

==================================== 83 passed in 857.27s (0:14:17) ====================================
```


## Code documentation

::: tests.integration.test_vulnerability_detector.test_feeds.debian.test_invalid_syntax_debian_feed

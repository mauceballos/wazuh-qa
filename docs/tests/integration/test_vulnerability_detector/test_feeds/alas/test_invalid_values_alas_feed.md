# Test invalid values Amazon Linux feed

Set of tests to check the behavior of Vulnerability Detector when the value of a tag is not correct: invalid type,
strange characters...

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 122 | 0:22:23 | test_invalid_values_alas_feed.py |


## Test logic

First a list of labels is created whose value will be replaced. 

```
test_data = [
    {'field': 'severity', 'type': []},
    {'field': 'publishedDate', 'type': []},
    {'field': 'lastModifiedDate', 'type': []},
    {'field': 'references', 'type': []},
    {'field': 'vulnerabilities', 'type': [list]},
    {'field': 'fixed_packages', 'type': []}
]
```

For each of these labels, a value is assigned from the following list:

```
[None, "", "dummy value", 12345, ['1', '2', '3', '4', '5'], "ñ", "テスト",
 "ИСПЫТАНИЕ", "测试", "اختبار"]
```

## Tests

- `test_no_feed_changes`: Check the original feed is successfully imported.
- `test_invalid_values_alas_feed`: The tests are based on modifying the feed assigning strange values.

## Checks

- [x] Feed is imported successfully with the original feed.
- [x] Vulnerabilities are inserted into the `vulnerabilities` database.
- [x] Action status message displayed in `ossec.log`.
- [x] `Modulesd` is running after the test (don't crash).

## Observed behavior

The feed will be imported successfully.

## Execution result

```
=============================================================== test session starts ================================================================
platform linux -- Python 3.7.3, pytest-6.2.3, py-1.10.0, pluggy-0.13.1
OS: CentOS 8, CPU: 2, memory: 2048
collected 122 items

tests/integration/test_vulnerability_detector/test_feeds/alas/test_invalid_values_alas_feed.py ............................................. [ 36%]
.............................................................................                                                                [100%]

========================================================= 122 passed in 1343.73s (0:22:23) =========================================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_feeds.alas.test_invalid_values_alas_feed

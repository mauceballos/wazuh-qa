# Test extra tags Amazon Linux feed

Set of tests that are based on checking the behavior of Vulnerability Detector when there is an extra tag in the feed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 244 | 0:46:20 | test_extra_tags_alas_feed.py |

## Test logic

For each of the following values a new label `<x>y</x>` will be created.

```
[[1, 2, 3], {"a": 1, "b": 2}, "extra_tag", 12345, "ñ", "テスト", "ИСПЫТАНИЕ", "测试", "اختبار", " ", ""]
```

For instance:

```
<[1, 2, 3]>[1, 2, 3]</[1, 2, 3]>, <[1, 2, 3]>{"a": 1, "b": 2}</[1, 2, 3]>, ...
```

## Tests

- `test_no_feed_changes`: Check the original feed is successfully imported.
- `test_extra_tags_alas_feed`: Check if the feeds are successfully imported when they contain new extra labels.

## Checks

- [x] Feed is imported successfully with the original feed.
- [x] Vulnerabilities are inserted into the `vulnerabilities` database.
- [x] Action status message displayed in `ossec.log`.
- [x] `wazuh-modulesd` is still running once the test has finished (it didn't crash).

## Observed behavior

The feed will be successfully imported if:

- The original feed is successfully imported.
- The modified feed contains valid tags. Those tags are not empty and the type of inserted tag is `string`.

For other cases, the feed will not be imported.

## Execution result

```
=============================================================== test session starts ================================================================
platform linux -- Python 3.7.3, pytest-6.2.3, py-1.10.0, pluggy-0.13.1
OS: CentOS 8, CPU: 2, memory: 2048
collected 244 items

tests/integration/test_vulnerability_detector/test_feeds/alas/test_extra_tags_alas_feed.py ................................................. [ 20%]
............................................................................................................................................ [ 77%]
.......................................................                                                                                      [100%]

========================================================= 244 passed in 2780.03s (0:46:20) =========================================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_feeds.alas.test_extra_tags_alas_feed
# Test missing tags Amazon Linux feed

Set of tests to check the behavior of Vulnerability Detector when a tag is missing in the feed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 14  | 0:02:23 | test_missing_tags_alas_feed.py |

## Test logic

Each test consists of removing one of the following tags from the feed:

```
['severity', 'publishedDate', 'lastModifiedDate', 'references', 'vulnerabilities', 'fixed_packages']
```

## Tests

- `test_no_feed_changes`: Check the original feed is successfully imported.
- `test_missing_tags_alas_feed`: The tests are based on removing a certain tag from feed.

## Checks

- [x] The original feed is successfully imported.
- [x] Vulnerabilities are inserted into the `vulnerabilities` database.
- [x] Action status message displayed in `ossec.log`.
- [x] `wazuh-modulesd` is still running once the test has finished (it didn't crash).

## Observed behavior

The feed will be imported succesfully.

## Execution result

```
========================================== test session starts =======================================
platform linux -- Python 3.6.8, pytest-6.2.2, py-1.10.0, pluggy-0.13.1
OS: CentOS 8, CPU: 2, memory: 2048
collected 14 items                                                                          

test_vulnerability_detector/test_feeds/alas/test_missing_tags_alas_feed.py ..............       [100%]

==================================== 14 passed in 143.05s (0:02:23) ==================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_feeds.alas.test_missing_tags_alas_feed

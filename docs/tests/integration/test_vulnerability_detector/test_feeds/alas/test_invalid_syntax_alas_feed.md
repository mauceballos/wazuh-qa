# Test invalid syntax Amazon Linux feed

Set of tests that check the behavior of Vulnerability Detector when the feed has some kind of syntactic error such as
missing character or closing tag, etc.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 2 | 110 | 0:22:10 | test_invalid_syntax_alas_feed.py |

## Test logic

A test is performed for each of the following cases:

- Delete `{`.
- Delete `{`.
- Add `{{`.
- Add `}}`.
- Add `{` in the middle of feed
- Add `}` in the middle of feed.
- Add `{}` in the middle of feed.
- Delete key:value comma `,`.
- Add a comma before value `key: ,value,`.
- Add double comma after `key:value,,`.
- Add double comma after list value `,,`.
- Close a key with double quotation marks.
- Close value with double quotation marks.
- Replace a comma with semicolon.
- Replace a colon with semicolon.
- Missing open bracket.
- Missing close bracket.
- Delete some information.

In addition, it has been added new tests with different characters.

```
['.', ':', '@', '#', '*', '-', '_', "'", '"', '/', '=', 'ñ', 'ç', '+', '^',
 '!', '?', '%', '&', '`', '¿', '?', '(', ')', '|', 'º', '$', '½', '¬',  '!',
 '~', '¡', '[', ']', '{', '}']
```

In this case, for each of the following characters, a test is performed in which:
 - Replace the symbol `,` with the character.

## Tests

- `test_no_feed_changes`: Check the original feed is successfully imported.
- `test_invalid_syntax_alas_feed`: The tests are based on modifying the feed causing syntax errors.

## Checks

- [x] Feed is imported successfully with the original feed.
- [x] Vulnerabilities are inserted into the `vulnerabilities` database.
- [x] Action status message displayed in `ossec.log`.
- [x] `wazuh-modulesd` is still running once the test has finished (it didn't crash).

## Observed behavior

The feed will be imported successfully if:

- Add `}}`. 

For other cases, the feed will not be imported.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.6.8, pytest-6.2.2, py-1.10.0, pluggy-0.13.1
OS: CentOS 8, CPU: 2, memory: 2048
collected 110 items                                                                                    
test_vulnerability_detector/test_feeds/alas/test_invalid_syntax_alas_feed.py ................... [ 17%]
...........................................................................................      [100%]
============================= 110 passed in 1330.50s (0:22:10) ==============================
```

## Code documentation


::: tests.integration.test_vulnerability_detector.test_feeds.alas.test_invalid_syntax_alas_feed

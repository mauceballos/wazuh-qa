# Test general settings interval

The tests will modify the value of `interval` tag in `ossec.conf`, set different times and check the result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 12 | 23.30s | test_general_settings_interval.py |

## Test logic

For different time units:

```
['s','m','h','d']
```

and time values:

```
[1,2,5]
```

The test will check in `ossec.log` if the following message appears:

```
<vulnerability_detector_prefix> Sleeping for (.*)...
```

## Checks

- [x] Vulnerability Detector process thread sleeps the time set, checking `ossec.log` message.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 12 items

test_vulnerability_detector/test_general_settings/test_general_settings_interval.py ............ [100%]

========================================= 12 passed in 23.30s ==========================================
```


## Code documentation

::: tests.integration.test_vulnerability_detector.test_general_settings.test_general_settings_interval

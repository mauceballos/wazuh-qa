# Test providers os

The tests will modify the value of `os` tag in `ossec.conf`, set different os for Canonical and Debian and check the
result in `ossec.log`.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 9 | 18.80s | test_providers_os.py |

## Test logic

Each of these elements will modify the `os` provider setting in the `ossec.conf`.

```
{'PROVIDER': 'canonical', 'OS': 'trusty'},
{'PROVIDER': 'canonical', 'OS': 'xenial'},
{'PROVIDER': 'canonical', 'OS': 'bionic'},
{'PROVIDER': 'debian', 'OS': 'wheezy'},
{'PROVIDER': 'debian', 'OS': 'stretch'},
{'PROVIDER': 'debian', 'OS': 'jessie'},
{'PROVIDER': 'debian', 'OS': 'buster'},
{'PROVIDER': 'redhat', 'OS': ''},
{'PROVIDER': 'nvd', 'OS': ''},
```

Then, it will run the following checks:

- If `os` provider has value (Canonical and Debian), then check this pattern in `ossec.log`

```
(.*)Starting '<provider_name>' database update
```

- If `os` provider has not any value (Red Hat and NVD), then check this pattern in `ossec.log`:

```
(.*)Could not find: warning 'os' option can only be used in a single-provider
```

## Checks

- [x] The provider os data update starts when `os` has a determined value.
- [x] A warning message appears when while using `os` tag in Red Hat and NVD providers.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
======================================== test session starts =========================================
platform linux -- Python 3.8.2, pytest-5.4.1, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, testinfra-5.0.0, metadata-1.8.0
collected 9 items

test_vulnerability_detector/test_providers/test_providers_os.py .........                       [100%]

========================================= 9 passed in 18.80s ==========================================
```

## Code documentation

::: tests.integration.test_vulnerability_detector.test_providers.test_providers_os

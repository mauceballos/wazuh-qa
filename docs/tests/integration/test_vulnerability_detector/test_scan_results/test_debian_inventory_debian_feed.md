# Test Debian inventory Debian feed

These tests will mock Debian systems and insert custom vulnerabilities and vulnerable packages to check if Vulnerability
Detector generates the alerts from the Debian provider feed.

## General info

|Tier | Number of tests | Time spent| Test file |
|:--:|:--:|:--:|:--:|
| 0 | 4 | 0:01:22 | test_debian_inventory_debian_feed.py |

## Test logic

For each Debian system:

```
BUSTER, STRETCH, JESSIE, WHEEZY
```

The test will run these actions:
- Clean NVD, `vulnerabilities`, and `sys_programs tables`.
- Mock the system.
- Insert a debian custom feed and vulnerable packages.
- Import NVD vulnerabilities from a custom NVD feed.
- Check this event in `ossec.log`:
  ```
  The '{package}' package .* from agent .* is vulnerable to '{cve}'
  ```

## Checks

- [x] A report of the corresponding vulnerabilities is generated in the `ossec.log`.

## Observed behavior

The expected behavior is carried out.

## Execution result

```
========================================= test session starts ==========================================
platform linux -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1
rootdir: /root/wazuh-qa/tests/integration, inifile: pytest.ini
plugins: html-2.0.1, metadata-1.9.0, testinfra-5.0.0
collected 4 items

test_vulnerability_detector/test_scan_results/test_debian_inventory_debian_feed.py ....          [100%]

===================================== 4 passed in 82.12s (0:01:22) =====================================
```


## Code documentation

::: tests.integration.test_vulnerability_detector.test_scan_results.test_debian_inventory_debian_feed
